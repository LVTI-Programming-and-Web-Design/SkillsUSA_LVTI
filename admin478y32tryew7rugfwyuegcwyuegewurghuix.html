<!DOCTYPE html>
<html lang="en">
<head>
    <!--
        git hub api access token: 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
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin478y32tryew7rugfwyuegcwyuegewurghuix</title>
    <style>
        html, body{
            text-align:center;
            align-items:center; 
            justify-content: center;
            padding-block: 1.5rem;
        }
        ul{
        
            display: flex;
            flex-direction: column; 
            list-style-position: inside; 
            text-align:center;
            
        }

        .cat_title{
            font-size: 1.25rem;
             font-weight: bold;
        }

        .profileFrame{
    display: inline-block;
    height: 300px;
    width: 241px;
    background-color: black;
    margin-top: 2rem;
    margin-left: 1rem;
    border-radius: 0px;
    cursor: pointer;
    margin-bottom: 90px;
    /*box-shadow: 2px 2px 10px black;*/
}

.profileImg{
    height: inherit;
    width: inherit;
    display: block;
    object-fit: cover;
    border-radius: inherit;
}
button{
    cursor: pointer;
    outline: none;
    padding: .5rem 1rem;
}

input{
    margin-block: 1rem;
}

.adisorEditSace{
    margin-top: 5rem;
    margin-bottom: .5rem;
}
        </style>
</head>
<body>
    <h1>Admin</h1>
<hr/>
    <h1 class="cat_title">Comittes Images</h1>
    <p>Name the files the same name as the comitte, ending with .jpg for each file</p>
    <ul>
        <li>Championship -> championship.jpg</li>
        <li>Community -> community.jpg</li>
        <li>Fundraising -> fundraising.jpg</li>
        <li>Leadership -> leadership.jpg</li>
        <li>Recruitment -> recruitment.jpg</li>
        <li>Social -> social.jpg</li>
        </ul>
        

    <legend>Drop folder/files</legend>
    <input id = "comittes_imgs_filedrop" type = "file" />


    <hr>

    <h1 class="cat_title">Slider Images</h1>
    <p>Name images in order 1-5 (max slider images is 5) and with .jpg extension</p>
    <p>Uploaded images will only replace the current imgs with identical filename</p>
    <p>Structure of slider images: </p>
    <ul>
        <li>img1.jpg</li>
        <li>img2.jpg</li>
        <li>img3.jpg</li>
        <li>img4.jpg</li>
        <li>img5.jpg</li>

    </ul>

    <legend>Drop folder/files</legend>
    <input id = "slider_imgs_filedrop" type = "file" />


    <hr>
    <h1 class="cat_title">About US page </h1>
    <p>For text files: files must end with .txt extension and have proper naming: </p>
    <ul>
        <li>English version -> eng_description.txt</li>
        <li>Spanish version -> spn_description.txt</li>

    </ul>

    <legend>Drop txt folder/files</legend>
    <input id="aboutUS_text_filedrop" type = "file" />
<br/>
<br/>
<br/>
    <legend>For images: mus have .jpg extension</legend>
    <input id="about_us_image_filedrop" type = "file" />


<hr>

<h1 class="cat_title">Advisors</h1>
 
<div class = "block">
    <h3>General rules:</h3>
    <ul>
        <li>all images names end in .jpg </li>
        <li>no special characters, including "/" and "."</li>
        <li>"_" - underscores are allowed</li>
    </ul>
</div>

<div id = "advisors">

</div>

<h3 class ="adisorEditSace">Edit Space (selected profiles will appear to edit below):</h3>
<div id ="popup"></div>

<hr>
</body>
<script>
 

 //fethcing advisor profiles: 
 fetch("../variables.json")
.then(async r=>r.json())
.then(_json=>{
 const advisorsJsonFileNames= _json.advisors;
 //console.log(advisorsJsonFileNames)
 for(let a of advisorsJsonFileNames){  

  const xhttp = new XMLHttpRequest();
 xhttp.onload = () =>{
            if(xhttp.readyState=4 && xhttp.status=="200"){ //"200" = okey status (suscesful/healthy)
            let obj = JSON.parse(xhttp.responseText);
             //console.log(obj)
 
             document.getElementById("advisors").innerHTML += `
               <div class="profileFrame">
                   <img class="profileImg" src = "../memberPage/advisorsImgs/${obj.img}"/>
                   <p class="memberName">${obj.name}</p>
               <p class="memberGrade">${obj.vocation}</p>
               <p class="memberGrade">${obj.grade_level}</p>
               <p class="memberPosition">${obj.position}</p>
               <button class = "button" id = "edit" onclick = 'modal(${JSON.stringify(obj)})'>Edit</button>
               <button class = "button" id = "edit" onclick="console.log('Hello Universe')">Delete</button>
                </div>
             `;

            }
          }



          xhttp.open("GET", `./memberPage/advisorsObjs/${a}`, true);
          xhttp.send()
        }

        }); 


function editOBJ(obj, changes){
    let currentOBJ = obj;
    for(let key in currentOBJ){
        if(changes.key != null || changes.key != ""){
            currentOBJ.key = changes.key;
        }
    }

    return currentOBJ; 
}

function modal(obj){

    let currentOBJ = obj; 
    console.log(currentOBJ); 

    document.getElementById("popup").innerHTML= `
    <div class="profileFrame"> 
                   <img id = "profileImg" class="profileImg" src = "../memberPage/advisorsImgs/${obj.img}"/>

                   <div class = "imgUploadCont">
                    <input class = "imgUpload" id = "imgUpload" type = "file" accept=".jpeg, .jpg"/>    
                    <p>please upload an image file if you'd like to change it</p>
                    </div>

                   <input id="newName" type="text" class="memberName" placeholder='${obj.name}'/>
                   <input id="newVocation" type="text" class="memberVocation" placeholder='${obj.vocation}'/>

                   <input id="newGradeLevel" type="text" class="memberGrade" placeholder='${obj.grade_level}'/>

                   <input id="newPosition" type="text" class="memberName" placeholder='${obj.position}'/>
                 <button class="submitChanges" id = "submitChanges">Submit</button>
                </div>
        `;

    
      function deleteProfile(path){
        
        
      }

      deleteProfile("/workspaces/LynnTech_SkillsUSA_Website/memberPage/advisorsObjs/testOBJ.json")
 
        var changes = {};
    async function setChanges(obj){

            //console.log(obj);
            changes = obj;
           //console.log(obj.img)
            if(changes.img == null || changes.img == ""){
                delete changes.img
            }else{
                let reader = new FileReader();
                reader.onload = (e) =>{
                let resURL = (e.target.result);
                changes.img = resURL;
                //console.log("Added url:", changes)
                };

            reader.readAsDataURL(changes.img)
            }

            //maniupulate json files: test

             
            console.log(changes);
            
        }

        /*
        const reader = new FileReader();
        reader.onload  = () =>{
            localStorage.setItem("newImg", () => redaer.result, false); 
        }
        /**/

        document.getElementById("imgUpload").onchange = () =>{
            let reader = new FileReader();
            
                reader.onload = (e) =>{
                let resURL = (e.target.result);
                document.getElementById("profileImg").src = resURL; 
                };

            reader.readAsDataURL(document.getElementById("imgUpload").files[0])
        }

    document.getElementById("submitChanges").onclick = () =>{
     
        setChanges({
        "name": document.getElementById("newName").value,
        "vocation": document.getElementById("newVocation").value,
        "grade_level": document.getElementById("newGradeLevel").value,
        "position": document.getElementById("newPosition").value,
        "img": document.getElementById("imgUpload").files[0]
    })

    }; 


   
};


</script>
</html>